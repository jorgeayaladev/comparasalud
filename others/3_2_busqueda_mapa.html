<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resultados de Búsqueda - ComparaSalud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }

      .health-gradient {
        background: linear-gradient(135deg, #2563eb 0%, #10b981 100%);
      }

      #map {
        height: 100%;
        width: 100%;
        z-index: 1;
      }

      .leaflet-container {
        background: #f8fafc;
      }

      .custom-cluster {
        background: #2563eb;
        border: 3px solid white;
        border-radius: 50%;
        color: white;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .custom-marker {
        background: #10b981;
        border: 3px solid white;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }

      .provider-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .scrollbar-thin::-webkit-scrollbar {
        width: 4px;
      }

      .scrollbar-thin::-webkit-scrollbar-track {
        background: #f1f5f9;
      }

      .scrollbar-thin::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 2px;
      }

      .info-window {
        max-width: 280px;
      }

      @media (max-width: 768px) {
        .map-container {
          height: 50vh;
        }

        .results-container {
          height: 50vh;
        }
      }

      @media (min-width: 769px) {
        .main-container {
          height: 100vh;
        }

        .map-container {
          height: 100%;
        }

        .results-container {
          height: 100%;
        }
      }

      .skeleton-loader {
        background: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
      }

      @keyframes loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Header -->
    <header
      class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50"
    >
      <div class="container mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <!-- Logo y Navegación -->
          <div class="flex items-center space-x-4">
            <button class="lg:hidden text-gray-600">
              <i class="fas fa-bars text-xl"></i>
            </button>
            <div class="flex items-center space-x-2">
              <div
                class="w-8 h-8 health-gradient rounded-lg flex items-center justify-center"
              >
                <i class="fas fa-heartbeat text-white text-sm"></i>
              </div>
              <span class="font-bold text-gray-800 text-lg">ComparaSalud</span>
            </div>
          </div>

          <!-- Barra de Búsqueda -->
          <div class="flex-1 max-w-2xl mx-4">
            <div class="relative">
              <input
                type="text"
                placeholder="Buscar médicos, especialidades, procedimientos..."
                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                value="Cardiólogos en Lima"
              />
              <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
            </div>
          </div>

          <!-- Acciones de Usuario -->
          <div class="flex items-center space-x-4">
            <button class="text-gray-600 hover:text-blue-600">
              <i class="fas fa-sliders-h text-lg"></i>
            </button>
            <button class="text-gray-600 hover:text-blue-600">
              <i class="far fa-heart text-lg"></i>
            </button>
            <div
              class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"
            >
              <i class="fas fa-user text-gray-600"></i>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Layout Principal -->
    <div class="main-container flex flex-col lg:flex-row">
      <!-- Panel Lateral de Resultados -->
      <div
        class="results-container w-full lg:w-96 xl:w-108 bg-white border-r border-gray-200 flex flex-col"
      >
        <!-- Header del Panel -->
        <div class="p-4 border-b border-gray-200">
          <div class="flex items-center justify-between mb-2">
            <h1 class="text-lg font-semibold text-gray-800">
              Resultados de búsqueda
            </h1>
            <span
              class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded"
              >24 encontrados</span
            >
          </div>
          <p class="text-sm text-gray-600 flex items-center">
            <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
            Mostrando resultados cerca de Miraflores, Lima
          </p>

          <!-- Filtros Rápidos -->
          <div class="flex flex-wrap gap-2 mt-3">
            <button
              class="bg-blue-50 text-blue-700 text-xs font-medium px-3 py-1 rounded-full border border-blue-200"
            >
              <i class="fas fa-filter mr-1"></i>Filtros
            </button>
            <button
              class="bg-gray-100 text-gray-700 text-xs font-medium px-3 py-1 rounded-full"
            >
              Hoy disponible
            </button>
            <button
              class="bg-gray-100 text-gray-700 text-xs font-medium px-3 py-1 rounded-full"
            >
              Con seguro
            </button>
            <button
              class="bg-gray-100 text-gray-700 text-xs font-medium px-3 py-1 rounded-full"
            >
              4+ estrellas
            </button>
          </div>
        </div>

        <!-- Lista de Resultados -->
        <div class="flex-1 overflow-y-auto scrollbar-thin" id="results-list">
          <!-- Proveedor 1 -->
          <div
            class="provider-card border-b border-gray-100 p-4 hover:bg-blue-50 cursor-pointer transition-all duration-200"
            data-id="1"
          >
            <div class="flex space-x-3">
              <div class="flex-shrink-0">
                <div
                  class="w-16 h-16 health-gradient rounded-lg flex items-center justify-center"
                >
                  <i class="fas fa-stethoscope text-white text-xl"></i>
                </div>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between">
                  <h3 class="font-semibold text-gray-800 truncate">
                    Clínica San Felipe
                  </h3>
                  <div class="flex items-center space-x-1">
                    <i class="fas fa-star text-yellow-400 text-sm"></i>
                    <span class="text-sm font-medium text-gray-700">4.8</span>
                  </div>
                </div>
                <p class="text-sm text-gray-600 mt-1">
                  Cardiología • Medicina Interna
                </p>
                <div class="flex items-center text-sm text-gray-500 mt-2">
                  <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
                  <span class="truncate">Av. Salaverry 123, Miraflores</span>
                  <span class="mx-2">•</span>
                  <span>0.8 km</span>
                </div>
                <div class="flex items-center justify-between mt-2">
                  <div class="flex items-center space-x-4 text-sm">
                    <span class="text-green-600 font-semibold">S/ 120</span>
                    <span class="text-gray-500">consulta</span>
                  </div>
                  <div class="flex items-center space-x-1 text-blue-600">
                    <i class="fas fa-clock text-sm"></i>
                    <span class="text-xs">Hoy 14:30</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Proveedor 2 -->
          <div
            class="provider-card border-b border-gray-100 p-4 hover:bg-blue-50 cursor-pointer transition-all duration-200"
            data-id="2"
          >
            <div class="flex space-x-3">
              <div class="flex-shrink-0">
                <div
                  class="w-16 h-16 bg-purple-500 rounded-lg flex items-center justify-center"
                >
                  <i class="fas fa-heartbeat text-white text-xl"></i>
                </div>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between">
                  <h3 class="font-semibold text-gray-800 truncate">
                    Instituto Cardiológico
                  </h3>
                  <div class="flex items-center space-x-1">
                    <i class="fas fa-star text-yellow-400 text-sm"></i>
                    <span class="text-sm font-medium text-gray-700">4.9</span>
                  </div>
                </div>
                <p class="text-sm text-gray-600 mt-1">
                  Cardiología Intervencionista
                </p>
                <div class="flex items-center text-sm text-gray-500 mt-2">
                  <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
                  <span class="truncate"
                    >Av. Javier Prado 1455, San Isidro</span
                  >
                  <span class="mx-2">•</span>
                  <span>1.2 km</span>
                </div>
                <div class="flex items-center justify-between mt-2">
                  <div class="flex items-center space-x-4 text-sm">
                    <span class="text-green-600 font-semibold">S/ 180</span>
                    <span class="text-gray-500">consulta</span>
                  </div>
                  <div class="flex items-center space-x-1 text-blue-600">
                    <i class="fas fa-clock text-sm"></i>
                    <span class="text-xs">Mañana 10:00</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Proveedor 3 -->
          <div
            class="provider-card border-b border-gray-100 p-4 hover:bg-blue-50 cursor-pointer transition-all duration-200"
            data-id="3"
          >
            <div class="flex space-x-3">
              <div class="flex-shrink-0">
                <div
                  class="w-16 h-16 bg-cyan-500 rounded-lg flex items-center justify-center"
                >
                  <i class="fas fa-user-md text-white text-xl"></i>
                </div>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between">
                  <h3 class="font-semibold text-gray-800 truncate">
                    Dr. Carlos Rodríguez
                  </h3>
                  <div class="flex items-center space-x-1">
                    <i class="fas fa-star text-yellow-400 text-sm"></i>
                    <span class="text-sm font-medium text-gray-700">4.7</span>
                  </div>
                </div>
                <p class="text-sm text-gray-600 mt-1">
                  Cardiólogo • Ecocardiografía
                </p>
                <div class="flex items-center text-sm text-gray-500 mt-2">
                  <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
                  <span class="truncate"
                    >Clínica Delgado, Ave. Guardia Civil</span
                  >
                  <span class="mx-2">•</span>
                  <span>1.5 km</span>
                </div>
                <div class="flex items-center justify-between mt-2">
                  <div class="flex items-center space-x-4 text-sm">
                    <span class="text-green-600 font-semibold">S/ 150</span>
                    <span class="text-gray-500">consulta</span>
                  </div>
                  <div class="flex items-center space-x-1 text-blue-600">
                    <i class="fas fa-clock text-sm"></i>
                    <span class="text-xs">Hoy 16:00</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Más proveedores (simulados para scroll infinito) -->
          <div id="more-results">
            <!-- Los resultados adicionales se cargarán aquí -->
          </div>

          <!-- Indicador de carga -->
          <div id="loading-indicator" class="hidden p-4">
            <div class="flex space-x-3 animate-pulse">
              <div class="flex-shrink-0">
                <div class="w-16 h-16 skeleton-loader rounded-lg"></div>
              </div>
              <div class="flex-1 space-y-2">
                <div class="h-4 skeleton-loader rounded w-3/4"></div>
                <div class="h-3 skeleton-loader rounded w-1/2"></div>
                <div class="h-3 skeleton-loader rounded w-2/3"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer del Panel -->
        <div class="p-4 border-t border-gray-200 bg-gray-50">
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600">Mostrando 3 de 24 resultados</span>
            <button
              id="load-more"
              class="health-gradient text-white px-4 py-2 rounded-lg text-sm font-medium hover:shadow-md transition-all"
            >
              Cargar más resultados
            </button>
          </div>
        </div>
      </div>

      <!-- Mapa Interactivo -->
      <div class="map-container flex-1 relative">
        <div id="map"></div>

        <!-- Controles del Mapa -->
        <div class="absolute top-4 right-4 z-10 flex flex-col space-y-2">
          <button
            class="bg-white p-2 rounded-lg shadow-md hover:shadow-lg transition-all"
            title="Mi ubicación"
          >
            <i class="fas fa-location-arrow text-gray-700"></i>
          </button>
          <button
            class="bg-white p-2 rounded-lg shadow-md hover:shadow-lg transition-all"
            title="Zoom in"
          >
            <i class="fas fa-plus text-gray-700"></i>
          </button>
          <button
            class="bg-white p-2 rounded-lg shadow-md hover:shadow-lg transition-all"
            title="Zoom out"
          >
            <i class="fas fa-minus text-gray-700"></i>
          </button>
        </div>

        <!-- Cambiar Vista -->
        <div class="absolute bottom-4 left-4 z-10">
          <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <button
              class="px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border-r border-gray-200"
            >
              Mapa
            </button>
            <button
              class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600"
            >
              Satélite
            </button>
          </div>
        </div>

        <!-- Filtros en Mapa -->
        <div class="absolute top-4 left-4 z-10">
          <div class="bg-white rounded-lg shadow-md p-3">
            <div class="flex items-center space-x-2">
              <i class="fas fa-filter text-blue-600"></i>
              <span class="text-sm font-medium text-gray-700"
                >Filtros activos</span
              >
            </div>
            <div class="flex flex-wrap gap-1 mt-2">
              <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"
                >Cardiólogos</span
              >
              <span
                class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded"
                >S/ 100-200</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Info Window Template (oculto) -->
    <div id="info-window-template" class="hidden">
      <div class="info-window bg-white rounded-lg shadow-xl overflow-hidden">
        <div class="health-gradient p-4 text-white">
          <div class="flex items-center justify-between">
            <h3 class="font-bold text-lg" id="info-title">
              Clínica San Felipe
            </h3>
            <div
              class="flex items-center space-x-1 bg-white/20 px-2 py-1 rounded"
            >
              <i class="fas fa-star text-yellow-300"></i>
              <span class="font-semibold">4.8</span>
            </div>
          </div>
          <p class="text-white/90 text-sm mt-1" id="info-specialty">
            Cardiología • Medicina Interna
          </p>
        </div>
        <div class="p-4">
          <div class="flex items-center text-gray-600 text-sm mb-2">
            <i class="fas fa-map-marker-alt text-red-500 mr-2"></i>
            <span id="info-address">Av. Salaverry 123, Miraflores</span>
          </div>
          <div class="flex items-center text-gray-600 text-sm mb-3">
            <i class="fas fa-phone text-blue-500 mr-2"></i>
            <span id="info-phone">(01) 123-4567</span>
          </div>
          <div class="flex items-center justify-between mb-3">
            <span class="text-green-600 font-bold text-lg" id="info-price"
              >S/ 120</span
            >
            <span class="text-gray-500 text-sm">consulta</span>
          </div>
          <div class="flex space-x-2">
            <button
              class="flex-1 health-gradient text-white py-2 px-3 rounded text-sm font-medium hover:shadow-md transition-all"
            >
              <i class="far fa-calendar-alt mr-1"></i>Agendar
            </button>
            <button
              class="flex-1 border border-gray-300 text-gray-700 py-2 px-3 rounded text-sm font-medium hover:bg-gray-50 transition-all"
            >
              <i class="far fa-heart mr-1"></i>Guardar
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Inicializar mapa
        const map = L.map("map").setView([-12.1194, -77.0342], 14);

        // Capa base del mapa
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: "© OpenStreetMap contributors",
        }).addTo(map);

        // Datos de ejemplo para proveedores
        const providers = [
          {
            id: 1,
            name: "Clínica San Felipe",
            specialty: "Cardiología • Medicina Interna",
            lat: -12.1184,
            lng: -77.0302,
            rating: 4.8,
            address: "Av. Salaverry 123, Miraflores",
            phone: "(01) 123-4567",
            price: 120,
            available: true,
            color: "#2563EB",
          },
          {
            id: 2,
            name: "Instituto Cardiológico",
            specialty: "Cardiología Intervencionista",
            lat: -12.0972,
            lng: -77.0503,
            rating: 4.9,
            address: "Av. Javier Prado 1455, San Isidro",
            phone: "(01) 234-5678",
            price: 180,
            available: true,
            color: "#8B5CF6",
          },
          {
            id: 3,
            name: "Dr. Carlos Rodríguez",
            specialty: "Cardiólogo • Ecocardiografía",
            lat: -12.1256,
            lng: -77.0218,
            rating: 4.7,
            address: "Clínica Delgado, Ave. Guardia Civil",
            phone: "(01) 345-6789",
            price: 150,
            available: true,
            color: "#06B6D4",
          },
          {
            id: 4,
            name: "Centro Médico Miraflores",
            specialty: "Cardiología Preventiva",
            lat: -12.115,
            lng: -77.04,
            rating: 4.6,
            address: "Av. Angamos 1234, Miraflores",
            phone: "(01) 456-7890",
            price: 130,
            available: false,
            color: "#10B981",
          },
          {
            id: 5,
            name: "Hospital Nacional",
            specialty: "Cardiología Avanzada",
            lat: -12.105,
            lng: -77.045,
            rating: 4.5,
            address: "Av. Brasil 600, Magdalena",
            phone: "(01) 567-8901",
            price: 200,
            available: true,
            color: "#F59E0B",
          },
        ];

        // Crear marcadores y clusters
        const markers = L.markerClusterGroup({
          chunkedLoading: true,
          maxClusterRadius: 50,
          iconCreateFunction: function (cluster) {
            const count = cluster.getChildCount();
            return L.divIcon({
              html: `<div class="custom-cluster" style="width: 40px; height: 40px;">${count}</div>`,
              className: "marker-cluster-custom",
              iconSize: L.point(40, 40),
            });
          },
        });

        // Añadir marcadores al mapa
        providers.forEach((provider) => {
          const marker = L.marker([provider.lat, provider.lng]).bindPopup(
            createPopupContent(provider)
          );

          marker.on("click", function () {
            // Resaltar la tarjeta correspondiente en la lista
            highlightProviderCard(provider.id);
          });

          markers.addLayer(marker);
        });

        map.addLayer(markers);

        // Función para crear contenido del popup
        function createPopupContent(provider) {
          return `
                    <div class="info-window bg-white rounded-lg shadow-xl overflow-hidden" style="width: 280px;">
                        <div class="health-gradient p-4 text-white">
                            <div class="flex items-center justify-between">
                                <h3 class="font-bold text-lg">${provider.name}</h3>
                                <div class="flex items-center space-x-1 bg-white/20 px-2 py-1 rounded">
                                    <i class="fas fa-star text-yellow-300"></i>
                                    <span class="font-semibold">${provider.rating}</span>
                                </div>
                            </div>
                            <p class="text-white/90 text-sm mt-1">${provider.specialty}</p>
                        </div>
                        <div class="p-4">
                            <div class="flex items-center text-gray-600 text-sm mb-2">
                                <i class="fas fa-map-marker-alt text-red-500 mr-2"></i>
                                <span>${provider.address}</span>
                            </div>
                            <div class="flex items-center text-gray-600 text-sm mb-3">
                                <i class="fas fa-phone text-blue-500 mr-2"></i>
                                <span>${provider.phone}</span>
                            </div>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-green-600 font-bold text-lg">S/ ${provider.price}</span>
                                <span class="text-gray-500 text-sm">consulta</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="flex-1 health-gradient text-white py-2 px-3 rounded text-sm font-medium hover:shadow-md transition-all" onclick="alert('Agendando cita con ${provider.name}')">
                                    <i class="far fa-calendar-alt mr-1"></i>Agendar
                                </button>
                                <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-3 rounded text-sm font-medium hover:bg-gray-50 transition-all">
                                    <i class="far fa-heart mr-1"></i>Guardar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
        }

        // Función para resaltar tarjeta de proveedor
        function highlightProviderCard(providerId) {
          // Remover resaltado anterior
          document.querySelectorAll(".provider-card").forEach((card) => {
            card.classList.remove("bg-blue-100", "border-blue-300");
            card.classList.add("border-gray-100");
          });

          // Resaltar tarjeta actual
          const currentCard = document.querySelector(
            `.provider-card[data-id="${providerId}"]`
          );
          if (currentCard) {
            currentCard.classList.add("bg-blue-100", "border-blue-300");
            currentCard.classList.remove("border-gray-100");
            currentCard.scrollIntoView({ behavior: "smooth", block: "center" });
          }
        }

        // Sincronización entre lista y mapa
        document.querySelectorAll(".provider-card").forEach((card) => {
          card.addEventListener("click", function () {
            const providerId = parseInt(this.getAttribute("data-id"));
            const provider = providers.find((p) => p.id === providerId);

            if (provider) {
              // Centrar mapa en el proveedor
              map.setView([provider.lat, provider.lng], 16);

              // Abrir popup del marcador
              markers.getLayers().forEach((layer) => {
                const latLng = layer.getLatLng();
                if (
                  latLng.lat === provider.lat &&
                  latLng.lng === provider.lng
                ) {
                  layer.openPopup();
                }
              });

              // Resaltar tarjeta
              highlightProviderCard(providerId);
            }
          });
        });

        // Scroll infinito simulado
        let loadedResults = 3;
        const totalResults = 24;

        document
          .getElementById("load-more")
          .addEventListener("click", function () {
            const loadingIndicator =
              document.getElementById("loading-indicator");
            const moreResultsContainer =
              document.getElementById("more-results");

            // Mostrar indicador de carga
            loadingIndicator.classList.remove("hidden");

            // Simular carga de datos
            setTimeout(() => {
              loadingIndicator.classList.add("hidden");

              // Añadir más resultados (simulados)
              for (
                let i = loadedResults + 1;
                i <= loadedResults + 3 && i <= totalResults;
                i++
              ) {
                const newProvider = document.createElement("div");
                newProvider.className =
                  "provider-card border-b border-gray-100 p-4 hover:bg-blue-50 cursor-pointer transition-all duration-200";
                newProvider.setAttribute("data-id", i);
                newProvider.innerHTML = `
                            <div class="flex space-x-3">
                                <div class="flex-shrink-0">
                                    <div class="w-16 h-16 health-gradient rounded-lg flex items-center justify-center">
                                        <i class="fas fa-stethoscope text-white text-xl"></i>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-start justify-between">
                                        <h3 class="font-semibold text-gray-800 truncate">Proveedor ${i}</h3>
                                        <div class="flex items-center space-x-1">
                                            <i class="fas fa-star text-yellow-400 text-sm"></i>
                                            <span class="text-sm font-medium text-gray-700">4.${
                                              Math.floor(Math.random() * 4) + 5
                                            }</span>
                                        </div>
                                    </div>
                                    <p class="text-sm text-gray-600 mt-1">Cardiología • Especialidad</p>
                                    <div class="flex items-center text-sm text-gray-500 mt-2">
                                        <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
                                        <span class="truncate">Dirección ejemplo ${i}, Lima</span>
                                        <span class="mx-2">•</span>
                                        <span>${(Math.random() * 2 + 1).toFixed(
                                          1
                                        )} km</span>
                                    </div>
                                    <div class="flex items-center justify-between mt-2">
                                        <div class="flex items-center space-x-4 text-sm">
                                            <span class="text-green-600 font-semibold">S/ ${
                                              Math.floor(Math.random() * 100) +
                                              100
                                            }</span>
                                            <span class="text-gray-500">consulta</span>
                                        </div>
                                        <div class="flex items-center space-x-1 text-blue-600">
                                            <i class="fas fa-clock text-sm"></i>
                                            <span class="text-xs">Próxima disponibilidad</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;

                // Añadir evento click al nuevo proveedor
                newProvider.addEventListener("click", function () {
                  const id = parseInt(this.getAttribute("data-id"));
                  highlightProviderCard(id);
                });

                moreResultsContainer.appendChild(newProvider);
              }

              loadedResults += 3;

              // Actualizar contador
              document.querySelector(
                ".text-gray-600"
              ).textContent = `Mostrando ${Math.min(
                loadedResults,
                totalResults
              )} de ${totalResults} resultados`;

              // Ocultar botón si no hay más resultados
              if (loadedResults >= totalResults) {
                this.style.display = "none";
              }
            }, 1000);
          });

        // Geolocalización del usuario
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function (position) {
            const userLat = position.coords.latitude;
            const userLng = position.coords.longitude;

            // Añadir marcador de usuario
            const userMarker = L.marker([userLat, userLng])
              .addTo(map)
              .bindPopup("Tu ubicación actual")
              .openPopup();

            // Icono personalizado para el usuario
            userMarker.setIcon(
              L.divIcon({
                html: '<div class="custom-marker bg-red-500"><i class="fas fa-user"></i></div>',
                className: "user-marker",
                iconSize: [40, 40],
              })
            );
          });
        }
      });
    </script>
  </body>
</html>
